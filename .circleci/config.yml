version: 2.1
executors:
  default:
    docker:
      - image: cimg/base:stable
jobs: 
  build:
    executor: default
    steps:
      - checkout
      - run: exit 1
      - run: 
          name: API call to report status (on success)
          command: |
             curl -X POST -H "Accept: application/vnd.github+json" -H "Authorization: token $VIJAY_GITHUB_PAT" https://api.github.com/repos/$CIRCLE_PROJECT_USERNAME/$CIRCLE_PROJECT_REPONAME/statuses/$CIRCLE_SHA1 -d '{"state":"success","target_url":"https://github.com/vjpandian/server4-pr-test","description":"Tests passed successfully","context":"main"}'
          when: on_success
      - run: 
          name: API call to report status (on failure)
          command: |
             curl -X POST -H "Accept: application/vnd.github+json" -H "Authorization: token $VIJAY_GITHUB_PAT" https://api.github.com/repos/$CIRCLE_PROJECT_USERNAME/$CIRCLE_PROJECT_REPONAME/statuses/$CIRCLE_SHA1 -d '{"state":"failure","target_url":"https://github.com/vjpandian/server4-pr-test","description":"Tests failed","context":"main"}'
          when: on_fail

             

workflows:
  main:
    jobs:
      - build:
          context: org-global
